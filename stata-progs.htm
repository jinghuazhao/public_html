<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns="http://www.w3.org/TR/REC-html40" xmlns:v = 
"urn:schemas-microsoft-com:vml" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:w = 
"urn:schemas-microsoft-com:office:word" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><head><title>SAS Programs</title>
<meta http-equiv="Content-Type" content="text/html; charset=unicode">
<meta content="Word.Document" name="ProgId">
<meta content="MSHTML 6.00.6000.17114" name="GENERATOR">
<meta content="Microsoft Word 11" name="Originator"><link 
href="r-progs_files/filelist.xml" rel=File-List><link 
href="r-progs_files/editdata.mso" rel=Edit-Time-Data><!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><o:smarttagtype 
namespaceuri="urn:schemas-microsoft-com:office:smarttags" 
name="PersonName"></o:smarttagtype><!--[if gte mso 9]><xml>
 <o:documentproperties>
  <o:author>rmjdjhz</o:author>
  <o:template>Normal</o:template>
  <o:lastauthor>jhz22</o:lastauthor>
  <o:revision>21</o:revision>
  <o:totaltime>49</o:totaltime>
  <o:created>2005-07-26T10:08:00Z</o:created>
  <o:lastsaved>2006-05-23T08:12:00Z</o:lastsaved>
  <o:pages>1</o:pages>
  <o:words>1123</o:words>
  <o:characters>6403</o:characters>
  <o:company>University College London</o:company>
  <o:lines>53</o:lines>
  <o:paragraphs>15</o:paragraphs>
  <o:characterswithspaces>7511</o:characterswithspaces>
  <o:version>11.6568</o:version>
 </o:documentproperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:worddocument>
  <w:zoom>75</w:zoom>
  <w:validateagainstschemas/>
  <w:saveifxmlinvalid>false</w:saveifxmlinvalid>
  <w:ignoremixedcontent>false</w:ignoremixedcontent>
  <w:alwaysshowplaceholdertext>false</w:alwaysshowplaceholdertext>
  <w:compatibility>
   <w:applybreakingrules/>
   <w:usefelayout/>
  </w:compatibility>
  <w:browserlevel>MicrosoftInternetExplorer4</w:browserlevel>
 </w:worddocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:latentstyles deflockedstate="false" latentstylecount="156">
 </w:latentstyles>
</xml><![endif]--><!--[if !mso]>
<object id="ieooui" classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D"></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
  </style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<meta content="Jing" name="Author"><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="6146"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]--></head>
<body lang="EN-GB" vlink="blue" link="blue">
<p class="Section1"><b><span lang="EN-US" 
style="FONT-SIZE: 18pt; FONT-FAMILY: Arial">Stata programs by Jing Hua 
Zhao</span></b></p>
<p class="Section1"><span lang="EN-US">The following is for Hardy-Weinberg 
equilibrium exact test. .</span></p>
<p class="Section1"><span lang="EN-US">program stata_snphwe, plugin using 
("stata_snphwe.plugin")<br>/*an testing example for Stata*/<br>input all_aa 
all_ab all_bb<br>1 2 3<br>10 20 30<br>100 200 300<br>end<br>qui gen 
p=.<br>forval i=1/`=_N' {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; local 
aa=all_aa[`i']<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; local 
ab=all_ab[`i']<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; local 
bb=all_bb[`i']<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; qui genhwi `aa' `ab' 
`bb'<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; qui replace p=r(p_exact) in 
`i'<br>}<br>list<br>qui gen p_exact=.<br>plugin call stata_snphwe all_aa all_ab 
all_bb p_exact<br>list</span></p> <p class="Section1"><span lang="EN-US"> 
The C code below is contained in <a href="software/stata_snphwe.c">stata_snphwe.c</a>.
It works on summary genotype data and for one 
genome-wide association analysis it would take 30-node Linux cluster 40 days 
with <a href="http://biostat-resources.com/stata/des_genhw.htm">genhw</a>&nbsp;but only 
within an hour using this code. A SAS counterpart has 
also been implemented.</span></p>
<p class="Section1"><span lang="EN-US">I have also used C to connect MySQL as is 
shown (in <a href="software/connect_to_mysql.do">connect_to_mysql.do</a> and <a 
href="software/connect_to_mysql.c">connect_to_mysql.c</a>) here.</span></p>
<p class="Section1"><i><span lang="EN-US">Date last 
changed&nbsp;22/10/2012</span></i></p></body></html>
